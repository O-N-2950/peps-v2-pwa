# 1. On force les providers : Python d'abord, Node ensuite.
# CELA EMPÃŠCHE NIXPACKS DE LANCER CADDY.
providers = ["python", "node"]

[phases.setup]
nixPkgs = ["python3", "nodejs", "npm"]

[phases.install]
cmds = [
  "cd frontend && npm install",
  "cd backend && pip install -r requirements.txt"
]

[phases.build]
cmds = ["cd frontend && npm run build"]

[start]
# On lance Gunicorn explicitement sur le port fourni par Railway ($PORT)
cmd = "cd backend && gunicorn -k eventlet -w 1 --bind 0.0.0.0:$PORT app:app"
